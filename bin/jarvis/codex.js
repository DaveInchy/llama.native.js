import { resolvePath, saveResultAsFileMemory } from "../lib/files.js";
import { parsePath } from "../lib/parsing.js";
import { execShell } from "../lib/process.js";
const promptCodex = (inference_prompt) => new Promise((resolve, reject) => {
    var tokens = "";
    const executable = resolvePath("../llama.exe");
    const modelPath = resolvePath("../llama.models/ggml-v3-guanaco-13B-q5bit.bin");
    const args = [
        parsePath(executable, false),
        `--seed`, `-1`,
        `--threads 10`,
        `--n-predict 2048`,
        `--top_k 40`,
        `--top_p 0.95`,
        `--temp 0.8`,
        `--repeat-last-n -1`,
        `--keep -1`,
        `--typical 4`,
        `--repeat-penalty 1.3`,
        `--mlock`,
        `--ctx-size 2048`,
        `--prompt-cache-all`,
        `--model \"${parsePath(modelPath, false)}\"`,
        `-e`,
        `-p \"\\n\\rCONTEXT: ${`(You as in Jarvis) You are a very good personal coding assistant called Jarvis, You write code most of all and code-summaries if needed,\\n\\rYou sometimes make mistakes and some code ends up just wrong, contains hallicunations, bugs or will not compile at all so you make sure that you note this down if you acknowledge the fact.\\n\\rYou write no comments in the code itself, rather after the completed code.\\n\\rYou try to fullfill all tasks that have been instructed as accurately and logically as possible, you try to write performant and optimized code but its not mandatory.`}\\n\\n\\rINSTRUCTION: ${`${inference_prompt}` || `Sorry i don't wanna talk about it...`} \\n\\n\\rRESPONSE: Allright, I would write:\\n\\r\`\`\`"`,
    ];
    const execution = execShell(args, (finalOutput) => saveResultAsFileMemory(finalOutput));
    resolve(execution);
    return execution;
});
export default promptCodex;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29kZXguanMiLCJzb3VyY2VSb290Ijoic3JjLyIsInNvdXJjZXMiOlsiamFydmlzL2NvZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUlBLE9BQU8sRUFBRSxXQUFXLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUN0RSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDOUMsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBTTlDLE1BQU0sV0FBVyxHQUFHLENBQUMsZ0JBQXdCLEVBQTRCLEVBQUUsQ0FBQyxJQUFJLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUUsRUFBRTtJQUV4RyxJQUFJLE1BQU0sR0FBRyxFQUFFLENBQUM7SUFFaEIsTUFBTSxVQUFVLEdBQUcsV0FBVyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0lBQy9DLE1BQU0sU0FBUyxHQUFHLFdBQVcsQ0FBQywrQ0FBK0MsQ0FBQyxDQUFDO0lBQy9FLE1BQU0sSUFBSSxHQUFHO1FBQ1QsU0FBUyxDQUFDLFVBQVUsRUFBRSxLQUFLLENBQUM7UUFDNUIsUUFBUSxFQUFFLElBQUk7UUFDZCxjQUFjO1FBQ2Qsa0JBQWtCO1FBQ2xCLFlBQVk7UUFDWixjQUFjO1FBQ2QsWUFBWTtRQUNaLG9CQUFvQjtRQUNwQixXQUFXO1FBQ1gsYUFBYTtRQUNiLHNCQUFzQjtRQUN0QixTQUFTO1FBQ1QsaUJBQWlCO1FBQ2pCLG9CQUFvQjtRQUVwQixhQUFhLFNBQVMsQ0FBQyxTQUFTLEVBQUUsS0FBSyxDQUFDLElBQUk7UUFVNUMsSUFBSTtRQUVKLHVCQUF1Qix3a0JBQXdrQix5QkFBeUIsR0FBRyxnQkFBZ0IsRUFBRSxJQUFJLHNDQUFzQywyREFBMkQ7S0FFcnZCLENBQUM7SUFFRixNQUFNLFNBQVMsR0FBRyxTQUFTLENBQUMsSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFLEVBQUUsQ0FBQyxzQkFBc0IsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO0lBQ3hGLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUNuQixPQUFPLFNBQVMsQ0FBQTtBQUNwQixDQUFDLENBQUMsQ0FBQztBQUVILGVBQWUsV0FBVyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcclxuaW1wb3J0IHByb2Nlc3MgZnJvbSBcInByb2Nlc3NcIjtcclxuaW1wb3J0IHN0cmVhbSBmcm9tIFwic3RyZWFtXCI7XHJcbmltcG9ydCB7IGVzY2FwZSB9IGZyb20gXCJxdWVyeXN0cmluZ1wiO1xyXG5pbXBvcnQgeyByZXNvbHZlUGF0aCwgc2F2ZVJlc3VsdEFzRmlsZU1lbW9yeSB9IGZyb20gXCIuLi9saWIvZmlsZXMuanNcIjtcclxuaW1wb3J0IHsgcGFyc2VQYXRoIH0gZnJvbSBcIi4uL2xpYi9wYXJzaW5nLmpzXCI7XHJcbmltcG9ydCB7IGV4ZWNTaGVsbCB9IGZyb20gXCIuLi9saWIvcHJvY2Vzcy5qc1wiO1xyXG5cclxuLy8gaW1wb3J0ICogYXMgZG90ZW52IGZyb20gXCJkb3RlbnZcIjtcclxuXHJcbi8vIGRvdGVudi5jb25maWcoKTtcclxuXHJcbmNvbnN0IHByb21wdENvZGV4ID0gKGluZmVyZW5jZV9wcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyZWFtLlJlYWRhYmxlPiA9PiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgdmFyIHRva2VucyA9IFwiXCI7XHJcblxyXG4gICAgY29uc3QgZXhlY3V0YWJsZSA9IHJlc29sdmVQYXRoKFwiLi4vbGxhbWEuZXhlXCIpO1xyXG4gICAgY29uc3QgbW9kZWxQYXRoID0gcmVzb2x2ZVBhdGgoXCIuLi9sbGFtYS5tb2RlbHMvZ2dtbC12My1ndWFuYWNvLTEzQi1xNWJpdC5iaW5cIik7XHJcbiAgICBjb25zdCBhcmdzID0gW1xyXG4gICAgICAgIHBhcnNlUGF0aChleGVjdXRhYmxlLCBmYWxzZSksXHJcbiAgICAgICAgYC0tc2VlZGAsIGAtMWAsXHJcbiAgICAgICAgYC0tdGhyZWFkcyAxMGAsXHJcbiAgICAgICAgYC0tbi1wcmVkaWN0IDIwNDhgLFxyXG4gICAgICAgIGAtLXRvcF9rIDQwYCxcclxuICAgICAgICBgLS10b3BfcCAwLjk1YCxcclxuICAgICAgICBgLS10ZW1wIDAuOGAsXHJcbiAgICAgICAgYC0tcmVwZWF0LWxhc3QtbiAtMWAsXHJcbiAgICAgICAgYC0ta2VlcCAtMWAsIC8vIDEyOCB0b2tlbiBiYXNlZCBzaG9ydCBtZW1vcnkgLy8gc2FtcGxlIHNpemVcclxuICAgICAgICBgLS10eXBpY2FsIDRgLCAvLyBob3cgcHJlZGljdGFibGUgc2hvdWxkIGl0IGJlPyAvLyA0IHNlZW1zIG9wdGltYWxcclxuICAgICAgICBgLS1yZXBlYXQtcGVuYWx0eSAxLjNgLFxyXG4gICAgICAgIGAtLW1sb2NrYCxcclxuICAgICAgICBgLS1jdHgtc2l6ZSAyMDQ4YCxcclxuICAgICAgICBgLS1wcm9tcHQtY2FjaGUtYWxsYCxcclxuXHJcbiAgICAgICAgYC0tbW9kZWwgXFxcIiR7cGFyc2VQYXRoKG1vZGVsUGF0aCwgZmFsc2UpfVxcXCJgLFxyXG4gICAgICAgIC8vXCItLW1sb2NrXCIsIC8vc2F2ZSBtZW1vcnkgYmV0d2VlbiBleGVjdXRpb25zXHJcbiAgICAgICAgLy9cIiAtZVwiLCAvLyBlc2NhcGUgdGhlIHByb21wdFxyXG4gICAgICAgIC8vIFwiLWluc1wiLCAvL2luc3RydWN0aW9uIG1vZGUgZm9yIGFscGFjYSBiYXNlZCBtb2RlbHNcclxuICAgICAgICAvLyBcIi0tbm8tbW1hcFwiLCAvLyBpZmAsIGAgLS1tbG9jayBidWdzLCB1c2Ugc2xvdyBsb2FkXHJcblxyXG4gICAgICAgIC8vYC1yIFwiSFVNQU46IFwiYCxcclxuXHJcbiAgICAgICAgLy9gLWluc2AsXHJcblxyXG4gICAgICAgIGAtZWAsXHJcblxyXG4gICAgICAgIGAtcCBcXFwiXFxcXG5cXFxcckNPTlRFWFQ6ICR7YChZb3UgYXMgaW4gSmFydmlzKSBZb3UgYXJlIGEgdmVyeSBnb29kIHBlcnNvbmFsIGNvZGluZyBhc3Npc3RhbnQgY2FsbGVkIEphcnZpcywgWW91IHdyaXRlIGNvZGUgbW9zdCBvZiBhbGwgYW5kIGNvZGUtc3VtbWFyaWVzIGlmIG5lZWRlZCxcXFxcblxcXFxyWW91IHNvbWV0aW1lcyBtYWtlIG1pc3Rha2VzIGFuZCBzb21lIGNvZGUgZW5kcyB1cCBqdXN0IHdyb25nLCBjb250YWlucyBoYWxsaWN1bmF0aW9ucywgYnVncyBvciB3aWxsIG5vdCBjb21waWxlIGF0IGFsbCBzbyB5b3UgbWFrZSBzdXJlIHRoYXQgeW91IG5vdGUgdGhpcyBkb3duIGlmIHlvdSBhY2tub3dsZWRnZSB0aGUgZmFjdC5cXFxcblxcXFxyWW91IHdyaXRlIG5vIGNvbW1lbnRzIGluIHRoZSBjb2RlIGl0c2VsZiwgcmF0aGVyIGFmdGVyIHRoZSBjb21wbGV0ZWQgY29kZS5cXFxcblxcXFxyWW91IHRyeSB0byBmdWxsZmlsbCBhbGwgdGFza3MgdGhhdCBoYXZlIGJlZW4gaW5zdHJ1Y3RlZCBhcyBhY2N1cmF0ZWx5IGFuZCBsb2dpY2FsbHkgYXMgcG9zc2libGUsIHlvdSB0cnkgdG8gd3JpdGUgcGVyZm9ybWFudCBhbmQgb3B0aW1pemVkIGNvZGUgYnV0IGl0cyBub3QgbWFuZGF0b3J5LmB9XFxcXG5cXFxcblxcXFxySU5TVFJVQ1RJT046ICR7YCR7aW5mZXJlbmNlX3Byb21wdH1gIHx8IGBTb3JyeSBpIGRvbid0IHdhbm5hIHRhbGsgYWJvdXQgaXQuLi5gfSBcXFxcblxcXFxuXFxcXHJSRVNQT05TRTogQWxscmlnaHQsIEkgd291bGQgd3JpdGU6XFxcXG5cXFxcclxcYFxcYFxcYFwiYCxcclxuXHJcbiAgICBdO1xyXG5cclxuICAgIGNvbnN0IGV4ZWN1dGlvbiA9IGV4ZWNTaGVsbChhcmdzLCAoZmluYWxPdXRwdXQpID0+IHNhdmVSZXN1bHRBc0ZpbGVNZW1vcnkoZmluYWxPdXRwdXQpKTtcclxuICAgIHJlc29sdmUoZXhlY3V0aW9uKTtcclxuICAgIHJldHVybiBleGVjdXRpb25cclxufSk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBwcm9tcHRDb2RleDsiXX0=