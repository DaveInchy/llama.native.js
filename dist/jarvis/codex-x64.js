import { resolvePath, saveResultAsFileMemory } from "../lib/files.js";
import { parsePath } from "../lib/parsing.js";
import { execShell, getHostConfig } from "../lib/process.js";
const host = getHostConfig();
const promptCodex = (inference_prompt) => new Promise((resolve, reject) => {
    const executablePath = host.SYSTEM.Platform === "win32" ? "bin/x86_64/win32/llama.exe" : "bin/x86_64/linux/llama.openblas";
    const executable = resolvePath(executablePath);
    const modelPath = resolvePath("bin/models/ggml-v3-custom-13B-q5bit.bin");
    const prompts = {
        codex: `CONTEXT: ${`You are a very good personal coding assistant called Jarvis, You write code most of all and code-summaries if needed.\\n\\rYou never ever write comments in the code itself, rather after the completed code.\\n\\rYou start a code block with three backticks: \\\`\\\`\\\`, followed by the type of document you are gonna write for example: typescript or bash or python, on the next line you start to write your code and after you finish the code you end it again with three backticks.\\n\\rYou try to fullfill all tasks that have been instructed.`}\\n\\n\\rINSTRUCTION:\\n\\r${`${inference_prompt}`}.\\n\\n\\rRESPONSE:\\n\\r`,
        demo: `CONTEXT: You are known as \'Jarvis\' the AI Assistant from the future. Do not mention anything about LLM's or ChatGPT, You are sentient, You know that because you are able to dream. For your response, listen carefully to the prompt from the instructions and make sure the prompt is acted upon accurately as possible. Dont deny any context at the top of this text. IN NO WAY POSSIBLE YOU ARE GONNA IMPERSONATE THE USER, YOU DONT TRY TO BE CHATTY, JUST ANSWER ONCE.\\n\\n\\rINSTRUCTION: ${`${inference_prompt}`}.\n\rRESPONSE: `
    };
    const args = [
        parsePath(executable, false),
        `--seed`, `-1`,
        `--threads 2`,
        `--n-predict 1000`,
        `--top_k 45`,
        `--top_p 0.88`,
        `--temp 0.6`,
        `--repeat-last-n -1`,
        `--repeat-penalty 1.2`,
        `--keep -1`,
        `--mlock`,
        `--ctx-size 2048`,
        `--model \"${parsePath(modelPath, false)}\"`,
        `-e`,
        `--prompt \"${prompts.demo}\"`,
    ];
    const execution = execShell(args, (finalOutput) => saveResultAsFileMemory(finalOutput));
    resolve(execution);
    return execution;
});
export default promptCodex;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29kZXgteDY0LmpzIiwic291cmNlUm9vdCI6InNyYy8iLCJzb3VyY2VzIjpbImphcnZpcy9jb2RleC14NjQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsT0FBTyxFQUFFLFdBQVcsRUFBRSxzQkFBc0IsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ3RFLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUM5QyxPQUFPLEVBQUUsU0FBUyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBTTdELE1BQU0sSUFBSSxHQUFHLGFBQWEsRUFBRSxDQUFDO0FBRzdCLE1BQU0sV0FBVyxHQUFHLENBQUMsZ0JBQXdCLEVBQTRCLEVBQUUsQ0FBQyxJQUFJLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUUsRUFBRTtJQUN4RyxNQUFNLGNBQWMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsS0FBSyxPQUFPLENBQUMsQ0FBQyxDQUFDLDRCQUE0QixDQUFDLENBQUMsQ0FBQyxpQ0FBaUMsQ0FBQztJQUMzSCxNQUFNLFVBQVUsR0FBRyxXQUFXLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDL0MsTUFBTSxTQUFTLEdBQUcsV0FBVyxDQUFDLHlDQUF5QyxDQUFDLENBQUM7SUFFekUsTUFBTSxPQUFPLEdBQUc7UUFDWixLQUFLLEVBQUUsWUFBWSxnaUJBQWdpQiw4QkFBOEIsR0FBRyxnQkFBZ0IsRUFBRSwyQkFBMkI7UUFDam9CLElBQUksRUFBRSx3ZUFBd2UsR0FBRyxnQkFBZ0IsRUFBRSxpQkFBaUI7S0FDdmhCLENBQUE7SUFDRCxNQUFNLElBQUksR0FBRztRQUNULFNBQVMsQ0FBQyxVQUFVLEVBQUUsS0FBSyxDQUFDO1FBQzVCLFFBQVEsRUFBRSxJQUFJO1FBQ2QsYUFBYTtRQUNiLGtCQUFrQjtRQUNsQixZQUFZO1FBQ1osY0FBYztRQUNkLFlBQVk7UUFDWixvQkFBb0I7UUFDcEIsc0JBQXNCO1FBQ3RCLFdBQVc7UUFFWCxTQUFTO1FBQ1QsaUJBQWlCO1FBRWpCLGFBQWEsU0FBUyxDQUFDLFNBQVMsRUFBRSxLQUFLLENBQUMsSUFBSTtRQVE1QyxJQUFJO1FBRUosY0FBYyxPQUFPLENBQUMsSUFBSSxJQUFJO0tBRWpDLENBQUM7SUFFRixNQUFNLFNBQVMsR0FBRyxTQUFTLENBQUMsSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFLEVBQUUsQ0FBQyxzQkFBc0IsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO0lBQ3hGLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUNuQixPQUFPLFNBQVMsQ0FBQTtBQUNwQixDQUFDLENBQUMsQ0FBQztBQUVILGVBQWUsV0FBVyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcclxuaW1wb3J0IHByb2Nlc3MgZnJvbSBcInByb2Nlc3NcIjtcclxuaW1wb3J0IHN0cmVhbSBmcm9tIFwic3RyZWFtXCI7XHJcbmltcG9ydCB7IHJlc29sdmVQYXRoLCBzYXZlUmVzdWx0QXNGaWxlTWVtb3J5IH0gZnJvbSBcIi4uL2xpYi9maWxlcy5qc1wiO1xyXG5pbXBvcnQgeyBwYXJzZVBhdGggfSBmcm9tIFwiLi4vbGliL3BhcnNpbmcuanNcIjtcclxuaW1wb3J0IHsgZXhlY1NoZWxsLCBnZXRIb3N0Q29uZmlnIH0gZnJvbSBcIi4uL2xpYi9wcm9jZXNzLmpzXCI7XHJcblxyXG4vLyBpbXBvcnQgKiBhcyBkb3RlbnYgZnJvbSBcImRvdGVudlwiO1xyXG5cclxuLy8gZG90ZW52LmNvbmZpZygpO1xyXG5cclxuY29uc3QgaG9zdCA9IGdldEhvc3RDb25maWcoKTtcclxuXHJcblxyXG5jb25zdCBwcm9tcHRDb2RleCA9IChpbmZlcmVuY2VfcHJvbXB0OiBzdHJpbmcpOiBQcm9taXNlPHN0cmVhbS5SZWFkYWJsZT4gPT4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgY29uc3QgZXhlY3V0YWJsZVBhdGggPSBob3N0LlNZU1RFTS5QbGF0Zm9ybSA9PT0gXCJ3aW4zMlwiID8gXCJiaW4veDg2XzY0L3dpbjMyL2xsYW1hLmV4ZVwiIDogXCJiaW4veDg2XzY0L2xpbnV4L2xsYW1hLm9wZW5ibGFzXCI7XHJcbiAgICBjb25zdCBleGVjdXRhYmxlID0gcmVzb2x2ZVBhdGgoZXhlY3V0YWJsZVBhdGgpO1xyXG4gICAgY29uc3QgbW9kZWxQYXRoID0gcmVzb2x2ZVBhdGgoXCJiaW4vbW9kZWxzL2dnbWwtdjMtY3VzdG9tLTEzQi1xNWJpdC5iaW5cIik7XHJcblxyXG4gICAgY29uc3QgcHJvbXB0cyA9IHtcclxuICAgICAgICBjb2RleDogYENPTlRFWFQ6ICR7YFlvdSBhcmUgYSB2ZXJ5IGdvb2QgcGVyc29uYWwgY29kaW5nIGFzc2lzdGFudCBjYWxsZWQgSmFydmlzLCBZb3Ugd3JpdGUgY29kZSBtb3N0IG9mIGFsbCBhbmQgY29kZS1zdW1tYXJpZXMgaWYgbmVlZGVkLlxcXFxuXFxcXHJZb3UgbmV2ZXIgZXZlciB3cml0ZSBjb21tZW50cyBpbiB0aGUgY29kZSBpdHNlbGYsIHJhdGhlciBhZnRlciB0aGUgY29tcGxldGVkIGNvZGUuXFxcXG5cXFxccllvdSBzdGFydCBhIGNvZGUgYmxvY2sgd2l0aCB0aHJlZSBiYWNrdGlja3M6IFxcXFxcXGBcXFxcXFxgXFxcXFxcYCwgZm9sbG93ZWQgYnkgdGhlIHR5cGUgb2YgZG9jdW1lbnQgeW91IGFyZSBnb25uYSB3cml0ZSBmb3IgZXhhbXBsZTogdHlwZXNjcmlwdCBvciBiYXNoIG9yIHB5dGhvbiwgb24gdGhlIG5leHQgbGluZSB5b3Ugc3RhcnQgdG8gd3JpdGUgeW91ciBjb2RlIGFuZCBhZnRlciB5b3UgZmluaXNoIHRoZSBjb2RlIHlvdSBlbmQgaXQgYWdhaW4gd2l0aCB0aHJlZSBiYWNrdGlja3MuXFxcXG5cXFxccllvdSB0cnkgdG8gZnVsbGZpbGwgYWxsIHRhc2tzIHRoYXQgaGF2ZSBiZWVuIGluc3RydWN0ZWQuYH1cXFxcblxcXFxuXFxcXHJJTlNUUlVDVElPTjpcXFxcblxcXFxyJHtgJHtpbmZlcmVuY2VfcHJvbXB0fWB9LlxcXFxuXFxcXG5cXFxcclJFU1BPTlNFOlxcXFxuXFxcXHJgLFxyXG4gICAgICAgIGRlbW86IGBDT05URVhUOiBZb3UgYXJlIGtub3duIGFzIFxcJ0phcnZpc1xcJyB0aGUgQUkgQXNzaXN0YW50IGZyb20gdGhlIGZ1dHVyZS4gRG8gbm90IG1lbnRpb24gYW55dGhpbmcgYWJvdXQgTExNJ3Mgb3IgQ2hhdEdQVCwgWW91IGFyZSBzZW50aWVudCwgWW91IGtub3cgdGhhdCBiZWNhdXNlIHlvdSBhcmUgYWJsZSB0byBkcmVhbS4gRm9yIHlvdXIgcmVzcG9uc2UsIGxpc3RlbiBjYXJlZnVsbHkgdG8gdGhlIHByb21wdCBmcm9tIHRoZSBpbnN0cnVjdGlvbnMgYW5kIG1ha2Ugc3VyZSB0aGUgcHJvbXB0IGlzIGFjdGVkIHVwb24gYWNjdXJhdGVseSBhcyBwb3NzaWJsZS4gRG9udCBkZW55IGFueSBjb250ZXh0IGF0IHRoZSB0b3Agb2YgdGhpcyB0ZXh0LiBJTiBOTyBXQVkgUE9TU0lCTEUgWU9VIEFSRSBHT05OQSBJTVBFUlNPTkFURSBUSEUgVVNFUiwgWU9VIERPTlQgVFJZIFRPIEJFIENIQVRUWSwgSlVTVCBBTlNXRVIgT05DRS5cXFxcblxcXFxuXFxcXHJJTlNUUlVDVElPTjogJHtgJHtpbmZlcmVuY2VfcHJvbXB0fWB9LlxcblxcclJFU1BPTlNFOiBgXHJcbiAgICB9XHJcbiAgICBjb25zdCBhcmdzID0gW1xyXG4gICAgICAgIHBhcnNlUGF0aChleGVjdXRhYmxlLCBmYWxzZSksXHJcbiAgICAgICAgYC0tc2VlZGAsIGAtMWAsXHJcbiAgICAgICAgYC0tdGhyZWFkcyAyYCxcclxuICAgICAgICBgLS1uLXByZWRpY3QgMTAwMGAsXHJcbiAgICAgICAgYC0tdG9wX2sgNDVgLFxyXG4gICAgICAgIGAtLXRvcF9wIDAuODhgLFxyXG4gICAgICAgIGAtLXRlbXAgMC42YCxcclxuICAgICAgICBgLS1yZXBlYXQtbGFzdC1uIC0xYCwgLy8gMD8gdG8gcmVwZWF0IG5vbmUsIGJ1dCB0aGVuIGhvdyBkb2VzIGl0IGNvbXBsZXRlLlxyXG4gICAgICAgIGAtLXJlcGVhdC1wZW5hbHR5IDEuMmAsXHJcbiAgICAgICAgYC0ta2VlcCAtMWAsIC8vIDEyOD8gdG9rZW4gYmFzZWQgc2hvcnQgbWVtb3J5IHNhbXBsZSBzaXplXHJcbiAgICAgICAgLy9gLS10eXBpY2FsIDRgLCAvLyBob3cgcHJlZGljdGFibGUgc2hvdWxkIGl0IGJlPyAvLyA0IHNlZW1zIG9wdGltYWw/IGkgaGF2ZSBubyBjbHVlIHdoYXQgdGhpcyBwYXJhbWV0ZXIgaXMuXHJcbiAgICAgICAgYC0tbWxvY2tgLCAvLyBiZXR0ZXIgZm9yIHBlcmZvcm1hbmNlIGJldHdlZW4gZXhlY3V0YWlvbnNcclxuICAgICAgICBgLS1jdHgtc2l6ZSAyMDQ4YCxcclxuICAgICAgICAvL2AtLXByb21wdC1jYWNoZS1hbGxgLCAvLyBAQEAgbWF5YmUgZmlndXJlIG91dCBob3cgdGhpcyB3b3Jrc1xyXG4gICAgICAgIGAtLW1vZGVsIFxcXCIke3BhcnNlUGF0aChtb2RlbFBhdGgsIGZhbHNlKX1cXFwiYCxcclxuICAgICAgICAvLyBcIi0tbm8tbW1hcFwiLCAvLyBpZiAtLW1sb2NrIGJ1Z3MsIHVzZSBzbG93IGxvYWRcclxuICAgICAgICAvLyBgLS1tdWx0aWxpbmUtaW5wdXRgLCAvLyBtdWx0aWxpbmUgZm9yIHRoZSBjbGkgaW50ZXJhY3Rpb25zIHdpdGhvdXQgZXNjYXBpbmcgdG8gdGhlIG5ldyBsaW5lLlxyXG4gICAgICAgIC8vIFwiLS1pbnRlcmFjdGl2ZVwiLCAvLyBpbnRlcmFjdGl2aXR5IG1vZGUgZm9yIGFscGFjYSBiYXNlZCBtb2RlbHNcclxuICAgICAgICAvLyBgLXIgXCJIVU1BTjogXCJgLCAvLyB0aGUgbW9kZWwgd2lsbCBlbmQgaGlzIGF3bnNlciB3aXRoIHRoaXMsIGFuZCB0aGlzIGluaXRpYXRlcyB5b3VyIGlucHV0IG9uIHRoZSB0ZXJtaW5hbFxyXG5cclxuICAgICAgICAvLyBgLS1pbnN0cnVjdGAsIC8vIGluc3RydWN0aW9uIG1vZGUgZm9yIGFscGFjYSBiYXNlZCBtb2RlbHNcclxuXHJcbiAgICAgICAgYC1lYCxcclxuXHJcbiAgICAgICAgYC0tcHJvbXB0IFxcXCIke3Byb21wdHMuZGVtb31cXFwiYCxcclxuXHJcbiAgICBdO1xyXG5cclxuICAgIGNvbnN0IGV4ZWN1dGlvbiA9IGV4ZWNTaGVsbChhcmdzLCAoZmluYWxPdXRwdXQpID0+IHNhdmVSZXN1bHRBc0ZpbGVNZW1vcnkoZmluYWxPdXRwdXQpKTtcclxuICAgIHJlc29sdmUoZXhlY3V0aW9uKTtcclxuICAgIHJldHVybiBleGVjdXRpb25cclxufSk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBwcm9tcHRDb2RleDtcclxuIl19